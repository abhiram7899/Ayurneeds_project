<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel | Ayurneeds</title>
    <link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* GLOBAL SETTINGS */
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 0; }
        .admin-wrapper { display: none; max-width: 1000px; margin: 50px auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.1); overflow: hidden; grid-template-columns: 1fr 1fr; min-height: 600px; }
        .form-section { padding: 50px; display: flex; flex-direction: column; justify-content: center; }
        .form-section h2 { color: #2c3e50; font-size: 2rem; margin-bottom: 10px; }
        .form-section p { color: #7f8c8d; margin-bottom: 30px; }
        .input-group { margin-bottom: 20px; position: relative; }
        .input-group label { display: block; font-weight: 600; color: #34495e; margin-bottom: 8px; font-size: 0.9rem; }
        .input-group input { width: 100%; padding: 15px; border: 2px solid #ecf0f1; border-radius: 10px; font-size: 1rem; transition: 0.3s; box-sizing: border-box; }
        .input-group input:focus { border-color: #27ae60; outline: none; background: #f9fffb; }
        .generate-btn { width: 100%; padding: 15px; background: #27ae60; color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: bold; cursor: pointer; transition: 0.3s; box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3); }
        .generate-btn:hover { background: #219150; transform: translateY(-2px); }
        .visual-section { background: linear-gradient(135deg, #2c3e50 0%, #27ae60 100%); color: white; padding: 50px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; position: relative; overflow: hidden; }
        .visual-content { position: relative; z-index: 2; }
        .visual-content h1 { font-size: 2.5rem; margin-bottom: 20px; }
        .visual-content p { font-size: 1.1rem; opacity: 0.9; line-height: 1.6; }
        .admin-icon { font-size: 80px; margin-bottom: 20px; display: block; }
        .circle { position: absolute; border-radius: 50%; background: rgba(255,255,255,0.1); }
        .c1 { width: 200px; height: 200px; top: -50px; left: -50px; }
        .c2 { width: 300px; height: 300px; bottom: -100px; right: -50px; }
        .success-card { margin-top: 30px; background: #e8f8f5; border: 2px dashed #27ae60; padding: 20px; border-radius: 10px; text-align: center; display: none; animation: slideDown 0.5s ease; }
        .success-card h3 { color: #27ae60; margin: 0 0 10px; }
        .link-box { background: white; padding: 10px; border-radius: 5px; border: 1px solid #ddd; font-family: monospace; color: #555; word-break: break-all; margin-bottom: 10px; font-size: 14px; }
        .copy-btn { background: #2c3e50; color: white; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer; font-size: 0.9rem; }
        .copy-btn:hover { background: #34495e; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) { .admin-wrapper { grid-template-columns: 1fr; margin: 20px; } .visual-section { padding: 40px 20px; } }
    </style>
</head>
<body>

    <header>
       <a href="index.html" class="logo">
        <img src="images/logo.png" alt="Ayurneeds Logo"></a>
        <div class="nav-links">
            <a href="index.html" class="nav-btn">Home</a>
            <a href="contact.html" class="nav-btn">Contact</a>
             <a href="about.html" class="nav-btn">About</a>
            <a href="store.html" class="nav-btn">Store</a>
           <a href="track.html" class="nav-btn">Track Order</a>
            <a href="admin.html" class="nav-btn nav-primary">Admin Login</a>
        </div>
    </header>

    <div id="adminContent" class="admin-wrapper">
        
        <div class="form-section">
            <h2>Register Doctor</h2>
            <p>Create a secure portal link for new doctors.</p>

            <div class="input-group">
                <label>üë®‚Äç‚öïÔ∏è Doctor Full Name</label>
                <input type="text" id="docName" placeholder="e.g. Dr. Ravi Kumar">
            </div>

            <div class="input-group">
                <label>üì± Mobile Number</label>
                <input type="tel" id="docPhone" placeholder="e.g. 9988776655">
            </div>

            <div class="input-group">
                <label>üìç Clinic Address / City</label>
                <input type="text" id="docAddress" placeholder="e.g. Shivamogga">
            </div>

            <button onclick="registerDoctor()" class="generate-btn">‚ú® Generate Magic Link</button>

            <div id="successArea" class="success-card">
                <h3>üéâ Registration Successful!</h3>
                <p style="font-size: 13px; margin-bottom: 5px;">Send this link to the doctor:</p>
                <div id="linkBox" class="link-box">https://...</div>
                <button onclick="copyLink()" class="copy-btn">üìã Copy Link</button>
            </div>
        </div>

        <div class="visual-section">
            <div class="circle c1"></div>
            <div class="circle c2"></div>
            <div class="visual-content">
                <span class="admin-icon">üõ°Ô∏è</span>
                <h1>Admin Control</h1>
                <p>Manage your pharmacy network efficiently.</p>
                <p style="margin-top: 20px; font-size: 0.9rem; opacity: 0.7;">
                    Securely generate unique access tokens for doctors to upload prescriptions directly to your system.
                </p>
            </div>
        </div>

    </div>

    <script>
        // ‚úÖ Live Render Backend URL
        const API_URL = "https://ayurneeds.com";

        window.onload = function() {
            if (sessionStorage.getItem("admin_access") === "true") {
                showAdmin();
            } else {
                const password = prompt("üîí Enter Admin Password:");
                if (password === "admin123") { 
                    sessionStorage.setItem("admin_access", "true");
                    showAdmin();
                } else {
                    alert("üö´ Wrong Password!");
                    window.location.href = "index.html"; 
                }
            }
        };

        function showAdmin() {
            document.getElementById("adminContent").style.display = "grid";
        }

        async function registerDoctor() {
            const name = document.getElementById('docName').value;
            const phone = document.getElementById('docPhone').value;
            const address = document.getElementById('docAddress').value;
            const btn = document.querySelector(".generate-btn");

            if(!name || !phone) { alert("Please fill Name and Phone."); return; }

            btn.innerText = "Generating...";
            btn.disabled = true;
            btn.style.background = "#95a5a6";
            
            try {
                const response = await fetch(`${API_URL}/register-doctor/`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        name: name, 
                        phone: phone, 
                        clinic_address: address || "City" 
                    })
                });

                if(!response.ok) throw new Error("Server Error");

                const data = await response.json();
                
                // Construct Link
                const magicLink = `${window.location.origin}${window.location.pathname.replace('admin.html', 'doctor.html')}?id=${data.unique_uuid}`;

                document.getElementById('successArea').style.display = "block";
                document.getElementById('linkBox').innerText = magicLink;
                
                btn.innerText = "‚ú® Generate Another";
                btn.disabled = false;
                btn.style.background = "#27ae60";

            } catch (error) {
                alert("‚ùå Error: Is the backend running?");
                btn.innerText = "Try Again";
                btn.disabled = false;
                btn.style.background = "#c0392b";
            }
        }

        function copyLink() {
            const linkText = document.getElementById('linkBox').innerText;
            navigator.clipboard.writeText(linkText).then(() => {
                const copyBtn = document.querySelector(".copy-btn");
                copyBtn.innerText = "‚úÖ Copied!";
                setTimeout(() => { copyBtn.innerText = "üìã Copy Link"; }, 2000);
            });
        }
    </script>
</body>
</html>